<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>تنزيل التطبيق</title>
  <meta name="description" content="صفحة رسمية لتنزيل آخر إصدار من التطبيق، مع اختيار تلقائي للنسخة المناسبة للجهاز." />

  <style>
    :root{
      --bg:#0b1020;
      --card:#0f172a;
      --card2:#0b1224;
      --border:rgba(255,255,255,.10);
      --text:#e5e7eb;
      --muted:#94a3b8;
      --primary:#22c55e;
      --primary2:#16a34a;
      --btn:#111827;
      --shadow: 0 12px 40px rgba(0,0,0,.35);
      --radius:18px;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      color:var(--text);
      font-family: system-ui, -apple-system, "Segoe UI", Tahoma, Arial;
      background:
        radial-gradient(900px 420px at 10% 10%, rgba(34,197,94,.18), transparent 60%),
        radial-gradient(900px 420px at 90% 0%, rgba(59,130,246,.12), transparent 60%),
        linear-gradient(180deg, var(--bg), #050816);
      min-height:100vh;
    }

    .wrap{max-width:980px;margin:0 auto;padding:34px 16px 60px}
    .header{
      display:flex;align-items:flex-start;justify-content:space-between;gap:14px;flex-wrap:wrap;
      margin-bottom:18px;
    }

    .brand{
      display:flex;align-items:center;gap:12px;
    }
    .logo{
      width:44px;height:44px;border-radius:14px;
      background: linear-gradient(135deg, rgba(34,197,94,.95), rgba(59,130,246,.65));
      box-shadow: 0 10px 30px rgba(34,197,94,.18);
      border:1px solid rgba(255,255,255,.18);
    }
    h1{margin:0;font-size:30px;letter-spacing:.2px}
    .sub{margin:6px 0 0;color:var(--muted);font-size:14px;line-height:1.7}

    .grid{
      display:grid;gap:16px;
      grid-template-columns: 1.2fr .8fr;
      margin-top:14px;
    }
    @media (max-width: 900px){
      .grid{grid-template-columns: 1fr}
    }

    .card{
      background: linear-gradient(180deg, rgba(15,23,42,.90), rgba(11,18,36,.92));
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding:18px;
    }

    .card h2{
      margin:0 0 8px;
      font-size:18px;
      letter-spacing:.2px;
    }
    .card p{margin:8px 0;color:var(--muted);line-height:1.8}

    .pill{
      display:inline-flex;align-items:center;gap:8px;
      padding:8px 10px;border-radius:999px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      color: var(--muted);
      font-size:12px;
      margin-top:6px;
    }
    .dot{
      width:9px;height:9px;border-radius:999px;background:rgba(34,197,94,.9);
      box-shadow: 0 0 0 4px rgba(34,197,94,.18);
    }

    .actions{
      display:flex;flex-wrap:wrap;gap:10px;margin-top:12px;
    }

    a.btn, button.btn{
      display:inline-flex;align-items:center;justify-content:center;gap:10px;
      padding:12px 14px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(17,24,39,.55);
      color: var(--text);
      text-decoration:none;
      cursor:pointer;
      transition: transform .08s ease, background .2s ease, border-color .2s ease;
      user-select:none;
      font-weight:600;
      min-height:44px;
    }
    a.btn:hover, button.btn:hover{
      transform: translateY(-1px);
      border-color: rgba(255,255,255,.22);
      background: rgba(17,24,39,.72);
    }
    a.btn:active, button.btn:active{transform: translateY(0px)}

    .btn.primary{
      background: linear-gradient(135deg, var(--primary), var(--primary2));
      border-color: rgba(34,197,94,.55);
      color:#04110a;
      box-shadow: 0 14px 34px rgba(34,197,94,.20);
    }
    .btn.primary:hover{
      background: linear-gradient(135deg, rgba(34,197,94,.95), rgba(22,163,74,.92));
      border-color: rgba(34,197,94,.70);
    }

    .btn.ghost{
      background: transparent;
      border-color: rgba(255,255,255,.18);
    }

    .btn small{font-weight:600;color:rgba(255,255,255,.75)}
    .row{display:flex;gap:10px;flex-wrap:wrap;margin-top:6px}

    .note{
      margin-top:12px;
      padding:12px 12px;
      border-radius: 14px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      color: var(--muted);
      font-size:13px;
      line-height:1.8;
    }

    .kbd{
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      font-size:12px;
      padding:2px 8px;
      border-radius:999px;
      background: rgba(0,0,0,.25);
      border:1px solid rgba(255,255,255,.10);
      color: rgba(229,231,235,.85);
    }

    .status{
      margin-top:10px;
      color: rgba(226,232,240,.92);
      font-size:13px;
      line-height:1.8;
    }
    .status .muted{color:var(--muted)}
    .status b{color:var(--text)}

    .list{
      margin:10px 0 0;
      padding:0;
      list-style:none;
    }
    .list li{
      padding:10px 10px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      margin-top:10px;
      display:flex;align-items:flex-start;justify-content:space-between;gap:12px;flex-wrap:wrap;
    }
    .list .meta{color:var(--muted);font-size:12px}
    .list .title{font-weight:700}
    .right{display:flex;gap:10px;flex-wrap:wrap}

    footer{
      margin-top:16px;
      color: rgba(148,163,184,.9);
      font-size:12px;
      text-align:center;
    }

    /* أيقونات بسيطة */
    .ico{width:18px;height:18px;display:inline-block}
    .ico svg{width:18px;height:18px;display:block}
  </style>
</head>

<body>
  <div class="wrap">
    <div class="header">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>تنزيل التطبيق</h1>
          <div class="sub">
            صفحة رسمية لتنزيل آخر إصدار. زر ذكي يرشّح النسخة المناسبة لجهازك، مع روابط مباشرة لكل المعماريات.
          </div>
        </div>
      </div>

      <div class="pill" id="envPill" title="كشف البيئة">
        <span class="dot" id="envDot"></span>
        <span id="envText">جارٍ التعرف على جهازك…</span>
      </div>
    </div>

    <div class="grid">
      <!-- بطاقة التنزيل -->
      <section class="card" aria-label="تنزيل">
        <h2>آخر إصدار</h2>
        <p>
          اضغط على <b>التنزيل الذكي</b> وسيتم ترشيح النسخة الأقرب لجهازك. إذا لم ينجح الكشف، استخدم الروابط اليدوية.
        </p>

        <div class="actions">
          <a class="btn primary" href="#" id="smartBtn">
            <span class="ico" aria-hidden="true">
              <svg viewBox="0 0 24 24" fill="none">
                <path d="M12 3v10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <path d="M7 10l5 5 5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M5 21h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
            </span>
            تنزيل النسخة المناسبة لجهازي
          </a>

          <a class="btn ghost" href="#manual">
            <span class="ico" aria-hidden="true">
              <svg viewBox="0 0 24 24" fill="none">
                <path d="M4 6h16M4 12h16M4 18h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
            </span>
            عرض كل النسخ
          </a>
        </div>

        <div class="status" id="smartStatus">
          <span class="muted">الحالة:</span> جاهز.
        </div>

        <div class="note">
          <b>مهم:</b> على أندرويد قد تحتاج لتفعيل <span class="kbd">Install unknown apps</span> أو
          <span class="kbd">مصادر غير معروفة</span> من إعدادات الجهاز قبل التثبيت.
        </div>

        <div id="manual" style="height:12px"></div>
        <h2 style="margin-top:8px">التحميل اليدوي</h2>

        <ul class="list" aria-label="روابط التحميل">
          <li>
            <div>
              <div class="title">arm64-v8a <span class="meta">— الموصى بها لمعظم الأجهزة الحديثة</span></div>
              <div class="meta">Android 64-bit (ARM)</div>
            </div>
            <div class="right">
              <a class="btn" id="btnArm64" href="https://github.com/abood202/my-app-site/releases/download/v1.0.0/app-arm64-v8a-release.apk">تنزيل</a>
            </div>
          </li>

          <li>
            <div>
              <div class="title">armeabi-v7a <span class="meta">— للأجهزة الأقدم</span></div>
              <div class="meta">Android 32-bit (ARM)</div>
            </div>
            <div class="right">
              <a class="btn" id="btnV7a" href="https://github.com/abood202/my-app-site/releases/download/v1.0.0/app-armeabi-v7a-release.apk">تنزيل</a>
            </div>
          </li>

          <li>
            <div>
              <div class="title">x86_64 <span class="meta">— غالبًا للمحاكيات</span></div>
              <div class="meta">Android Emulator / Intel</div>
            </div>
            <div class="right">
              <a class="btn" id="btnX86" href="https://github.com/abood202/my-app-site/releases/download/v1.0.0/app-x86_64-release.apk">تنزيل</a>
            </div>
          </li>
        </ul>
      </section>

      <!-- بطاقة الملاحظات/الدعم -->
      <aside class="card" aria-label="الدعم والملاحظات">
        <h2>اقتراحات وملاحظات</h2>
        <p>
          لديك اقتراح أو واجهت مشكلة؟ استخدم صفحة الـ Issues وسيصلني تقريرك بشكل منظم.
        </p>

        <div class="actions">
          <a class="btn" href="https://github.com/abood202/my-app-site/issues">
            <span class="ico" aria-hidden="true">
              <svg viewBox="0 0 24 24" fill="none">
                <path d="M12 22s8-4 8-10V6l-8-4-8 4v6c0 6 8 10 8 10Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
                <path d="M12 11v4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <path d="M12 8h.01" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
              </svg>
            </span>
            فتح صفحة Issues
          </a>
        </div>

        <div class="note">
          <b>نصيحة:</b> عند إرسال Bug report اذكر نوع الجهاز وإصدار أندرويد وخطوات تكرار المشكلة.
        </div>

        <h2 style="margin-top:14px">معلومات جهازك</h2>
        <p class="muted small" id="deviceInfo">جارٍ جمع المعلومات…</p>

        <div class="note">
          إن لم يتم التعرف على المعمارية بدقة (ABI)، ستبقى الروابط اليدوية هي الخيار الآمن.
        </div>
      </aside>
    </div>

    <footer>
      © صفحة تنزيل التطبيق — مُستضافة عبر GitHub Pages
    </footer>
  </div>

  <script>
    // عدّل هذه الروابط عند تغيير رقم الإصدار أو أسماء الملفات
    const APK = {
      arm64:  "https://github.com/abood202/my-app-site/releases/download/v1.0.0/app-arm64-v8a-release.apk",
      v7a:    "https://github.com/abood202/my-app-site/releases/download/v1.0.0/app-armeabi-v7a-release.apk",
      x86_64: "https://github.com/abood202/my-app-site/releases/download/v1.0.0/app-x86_64-release.apk",
    };

    const el = (id) => document.getElementById(id);

    function ua() { return navigator.userAgent || ""; }
    function uaLower(){ return ua().toLowerCase(); }

    function platformGuess(){
      if (navigator.userAgentData && navigator.userAgentData.platform) {
        return String(navigator.userAgentData.platform);
      }
      // fallback بسيط
      if (uaLower().includes("android")) return "Android";
      if (uaLower().includes("iphone") || uaLower().includes("ipad") || uaLower().includes("ios")) return "iOS";
      if (uaLower().includes("windows")) return "Windows";
      if (uaLower().includes("mac os")) return "macOS";
      if (uaLower().includes("linux")) return "Linux";
      return "Unknown";
    }

    function isAndroid(){
      const p = platformGuess().toLowerCase();
      return p.includes("android") || uaLower().includes("android");
    }

    // ملاحظة مهمة:
    // المتصفح لا يعطي ABI بشكل رسمي 100%، لذلك هذا "ترشيح" بالاعتماد على مؤشرات من UA.
    function guessAbi(){
      const u = uaLower();

      // x86_64: غالباً محاكي أو أجهزة Intel
      if (u.includes("x86_64") || (u.includes("x86") && !u.includes("arm")) || u.includes("intel")) return "x86_64";

      // arm64: مؤشرات 64-bit ARM
      if (u.includes("aarch64") || u.includes("armv8") || u.includes("arm64")) return "arm64";

      // v7a: مؤشرات 32-bit ARM
      if (u.includes("armv7") || u.includes("armeabi-v7a") || u.includes("armeabi")) return "v7a";

      // افتراضي
      return "arm64";
    }

    function prettyAbi(abi){
      if (abi === "arm64") return "arm64-v8a";
      if (abi === "v7a") return "armeabi-v7a";
      if (abi === "x86_64") return "x86_64";
      return "غير معروف";
    }

    function setEnvPill(){
      const platform = platformGuess();
      const android = isAndroid();
      el("envDot").style.background = android ? "rgba(34,197,94,.95)" : "rgba(239,68,68,.95)";
      el("envDot").style.boxShadow = android ? "0 0 0 4px rgba(34,197,94,.18)" : "0 0 0 4px rgba(239,68,68,.16)";
      el("envText").textContent = android ? `Android — جاهز للتنزيل` : `${platform} — ملفات APK لأندرويد فقط`;
    }

    function fillDeviceInfo(){
      const platform = platformGuess();
      const android = isAndroid();
      const abi = guessAbi();
      const txt = [
        `Platform: ${platform}`,
        `Android: ${android ? "Yes" : "No"}`,
        `ABI guess: ${prettyAbi(abi)}`,
        `User-Agent: ${ua()}`
      ].join("\n");

      // نعرضه كسطر/سطرين بشكل مرتب
      el("deviceInfo").innerHTML =
        `<span class="kbd">Platform</span> ${platform}<br>` +
        `<span class="kbd">Android</span> ${android ? "Yes" : "No"}<br>` +
        `<span class="kbd">ABI guess</span> ${prettyAbi(abi)}<br>` +
        `<span class="kbd">UA</span> <span style="word-break:break-word">${ua()}</span>`;
    }

    function smartDownload(e){
      e.preventDefault();

      const status = el("smartStatus");
      const android = isAndroid();
      const abi = guessAbi();

      if (!android){
        status.innerHTML = `<span class="muted">الحالة:</span> هذا الجهاز ليس Android. استخدم جهاز أندرويد للتثبيت.`;
        return;
      }

      const pick = APK[abi] ? abi : "arm64";
      status.innerHTML =
        `<span class="muted">الحالة:</span> تم ترشيح <b>${prettyAbi(pick)}</b> وسيبدأ التنزيل الآن…`;

      // بدء التحميل
      window.location.href = APK[pick];
    }

    // تفعيل
    setEnvPill();
    fillDeviceInfo();
    el("smartBtn").addEventListener("click", smartDownload);

    // تأكد الروابط اليدوية تربط لنفس الثوابت
    el("btnArm64").href = APK.arm64;
    el("btnV7a").href   = APK.v7a;
    el("btnX86").href   = APK.x86_64;
  </script>
</body>
</html>
