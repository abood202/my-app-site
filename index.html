<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>تنزيل التطبيق</title>

  <!-- ✅ لوجو الصفحة في التبويب/النافذة (Favicon) -->
  <!-- ضع ملف favicon داخل: assets/favicon.png (أو غيّر الاسم هنا) -->
  <link rel="icon" type="image/png" href="assets/favicon.png" />

  <!-- ✅ تحسينات اختيارية لأندرويد/الموبايل -->
  <meta name="theme-color" content="#0b1220" />
  <link rel="apple-touch-icon" href="assets/app_icon.png" />

  <style>
    :root{
      --bg1:#050b16;
      --bg2:#0b1d2a;
      --card:rgba(255,255,255,.06);
      --stroke:rgba(255,255,255,.10);
      --text:#e9eefc;
      --muted:rgba(233,238,252,.72);
      --muted2:rgba(233,238,252,.55);
      --shadow:0 18px 50px rgba(0,0,0,.55);
      --radius:22px;
      --good:rgba(34,197,94,.95);
      --bad:rgba(239,68,68,.95);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:system-ui, "Segoe UI", Tahoma, Arial;
      color:var(--text);
      background:
        radial-gradient(900px 420px at 12% 10%, rgba(34,197,94,.18), transparent 60%),
        radial-gradient(800px 360px at 88% 18%, rgba(56,189,248,.16), transparent 62%),
        radial-gradient(700px 380px at 42% 92%, rgba(168,85,247,.14), transparent 62%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
    }
    a{color:inherit}
    .wrap{max-width:1080px;margin:0 auto;padding:28px 16px 46px}
    .header{display:flex;align-items:flex-start;justify-content:space-between;gap:16px;margin-bottom:18px}
    .brand{display:flex;align-items:center;gap:14px;min-width:0}
    .brand h1{margin:0;font-size:36px;letter-spacing:.2px}
    .sub{margin-top:6px;color:var(--muted);line-height:1.75;max-width:680px}

    /* ✅ مربع اللوجو بجوار العنوان */
    .logo{
      width:56px;height:56px;border-radius:16px;
      overflow:hidden;
      display:grid;place-items:center;
      background:rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.12);
      box-shadow:0 12px 28px rgba(0,0,0,.35);
      flex:0 0 auto;
    }
    .logo img{
      width:100%;
      height:100%;
      object-fit:contain;     /* للأيقونات أفضل غالباً */
      padding:10px;
      display:block;
    }

    .pill{
      display:flex;align-items:center;gap:10px;
      padding:10px 12px;border-radius:999px;
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      color:var(--muted);
      white-space:nowrap;
      box-shadow:0 10px 24px rgba(0,0,0,.25);
    }
    .dot{
      width:10px;height:10px;border-radius:999px;
      background:rgba(148,163,184,.9);
      box-shadow:0 0 0 4px rgba(148,163,184,.18);
    }

    .grid{display:grid;grid-template-columns: 1.35fr .85fr;gap:16px;margin-top:10px}
    @media (max-width: 940px){
      .header{flex-direction:column}
      .grid{grid-template-columns:1fr}
      .pill{align-self:flex-start}
      .brand h1{font-size:30px}
    }

    .card{
      background:var(--card);
      border:1px solid var(--stroke);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:18px;
      backdrop-filter: blur(10px);
    }
    .card h2{margin:0 0 10px;font-size:22px}
    p{margin:0 0 12px;color:var(--muted);line-height:1.75}

    .actions{display:flex;flex-wrap:wrap;gap:10px;margin:12px 0 14px}
    .btn{
      display:inline-flex;align-items:center;justify-content:center;gap:10px;
      padding:12px 14px;border-radius:14px;
      border:1px solid rgba(255,255,255,.14);
      text-decoration:none;
      background:rgba(255,255,255,.06);
      color:var(--text);
      transition: transform .08s ease, background .15s ease, border-color .15s ease;
      user-select:none;
    }
    .btn:hover{transform: translateY(-1px);background:rgba(255,255,255,.08);border-color:rgba(255,255,255,.22)}
    .btn:active{transform: translateY(0px)}
    .btn.primary{
      background: linear-gradient(90deg, rgba(34,197,94,.92), rgba(16,185,129,.86));
      border-color: rgba(34,197,94,.30);
      color:#04120a;
      font-weight:700;
    }
    .btn.primary:hover{background: linear-gradient(90deg, rgba(34,197,94,.98), rgba(16,185,129,.92))}
    .btn.ghost{
      background:rgba(255,255,255,.03);
    }
    .ico{width:18px;height:18px;display:inline-flex}
    .ico svg{width:18px;height:18px}

    .status{
      margin-top:8px;
      padding:10px 12px;border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(0,0,0,.12);
      color:var(--muted);
    }
    .muted{color:var(--muted2)}
    .small{font-size:13px}

    .note{
      margin-top:12px;
      padding:12px 12px;border-radius:16px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(0,0,0,.10);
      color:var(--muted);
      line-height:1.7;
    }
    .kbd{
      display:inline-block;
      padding:2px 8px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.06);
      color:var(--text);
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size:12px;
      vertical-align:middle;
    }

    .list{list-style:none;margin:10px 0 0;padding:0;display:flex;flex-direction:column;gap:10px}
    .list li{
      display:flex;align-items:center;justify-content:space-between;gap:12px;
      padding:12px;border-radius:18px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(255,255,255,.04);
    }
    .title{font-weight:750;color:var(--text)}
    .meta{color:var(--muted2);font-size:13px;margin-top:4px}
    .right{display:flex;gap:8px;align-items:center}
    footer{margin-top:18px;color:rgba(233,238,252,.55);text-align:center;font-size:13px}
    .ua{word-break:break-word}
  </style>
</head>

<body>
  <div class="wrap">
    <div class="header">
      <div class="brand">
        <div class="logo">
          <!-- ✅ لوجو بجوار العنوان -->
          <img src="assets/app_icon.png" alt="أيقونة التطبيق">
        </div>
        <div>
          <h1>تنزيل التطبيق</h1>
          <div class="sub">
            صفحة رسمية لتنزيل آخر إصدار. زر ذكي يرشّح النسخة المناسبة لجهازك، مع روابط مباشرة لكل المعماريات.
          </div>
        </div>
      </div>

      <div class="pill" id="envPill" title="كشف البيئة">
        <span class="dot" id="envDot"></span>
        <span id="envText">جارٍ التعرف على جهازك…</span>
      </div>
    </div>

    <div class="grid">
      <!-- بطاقة التنزيل -->
      <section class="card" aria-label="تنزيل">
        <h2>آخر إصدار</h2>
        <p>
          اضغط على <b>التنزيل الذكي</b> وسيتم ترشيح النسخة الأقرب لجهازك. إذا لم ينجح الكشف، استخدم الروابط اليدوية.
        </p>

        <div class="actions">
          <a class="btn primary" href="#" id="smartBtn">
            <span class="ico" aria-hidden="true">
              <svg viewBox="0 0 24 24" fill="none">
                <path d="M12 3v10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <path d="M7 10l5 5 5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M5 21h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
            </span>
            تنزيل النسخة المناسبة لجهازي
          </a>

          <a class="btn ghost" href="#manual">
            <span class="ico" aria-hidden="true">
              <svg viewBox="0 0 24 24" fill="none">
                <path d="M4 6h16M4 12h16M4 18h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
            </span>
            عرض كل النسخ
          </a>
        </div>

        <div class="status" id="smartStatus">
          <span class="muted">الحالة:</span> جاهز.
        </div>

        <div class="note">
          <b>مهم:</b> على أندرويد قد تحتاج لتفعيل <span class="kbd">Install unknown apps</span> أو
          <span class="kbd">مصادر غير معروفة</span> من إعدادات الجهاز قبل التثبيت.
        </div>

        <div id="manual" style="height:12px"></div>
        <h2 style="margin-top:8px">التحميل اليدوي</h2>

        <ul class="list" aria-label="روابط التحميل">
          <li>
            <div>
              <div class="title">arm64-v8a <span class="meta">— الموصى بها لمعظم الأجهزة الحديثة</span></div>
              <div class="meta">Android 64-bit (ARM)</div>
            </div>
            <div class="right">
              <a class="btn" id="btnArm64" href="#">تنزيل</a>
            </div>
          </li>

          <li>
            <div>
              <div class="title">armeabi-v7a <span class="meta">— للأجهزة الأقدم</span></div>
              <div class="meta">Android 32-bit (ARM)</div>
            </div>
            <div class="right">
              <a class="btn" id="btnV7a" href="#">تنزيل</a>
            </div>
          </li>

          <li>
            <div>
              <div class="title">x86_64 <span class="meta">— غالبًا للمحاكيات</span></div>
              <div class="meta">Android Emulator / Intel</div>
            </div>
            <div class="right">
              <a class="btn" id="btnX86" href="#">تنزيل</a>
            </div>
          </li>
        </ul>
      </section>

      <!-- بطاقة الدعم -->
      <aside class="card" aria-label="الدعم والملاحظات">
        <h2>اقتراحات وملاحظات</h2>
        <p>
          لديك اقتراح أو واجهت مشكلة؟ استخدم صفحة الـ Issues وسيصلني تقريرك بشكل منظم.
        </p>

        <div class="actions">
          <a class="btn" href="https://github.com/abood202/my-app-site/issues">
            <span class="ico" aria-hidden="true">
              <svg viewBox="0 0 24 24" fill="none">
                <path d="M12 22s8-4 8-10V6l-8-4-8 4v6c0 6 8 10 8 10Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
                <path d="M12 11v4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <path d="M12 8h.01" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
              </svg>
            </span>
            فتح صفحة Issues
          </a>
        </div>

        <div class="note">
          <b>نصيحة:</b> عند إرسال Bug report اذكر نوع الجهاز وإصدار أندرويد وخطوات تكرار المشكلة.
        </div>

        <h2 style="margin-top:14px">معلومات جهازك</h2>
        <p class="muted small" id="deviceInfo">جارٍ جمع المعلومات…</p>

        <div class="note">
          إن لم يتم التعرف على المعمارية بدقة (ABI)، ستبقى الروابط اليدوية هي الخيار الآمن.
        </div>
      </aside>
    </div>

    <footer>
      © صفحة تنزيل التطبيق — مُستضافة عبر GitHub
    </footer>
  </div>

  <script>
    // ✅ عدّل هذه الروابط عند تغيير رقم الإصدار أو أسماء الملفات
    const APK = {
      arm64:  "https://github.com/abood202/my-app-site/releases/download/v1.0.0/app-arm64-v8a-release.apk",
      v7a:    "https://github.com/abood202/my-app-site/releases/download/v1.0.0/app-armeabi-v7a-release.apk",
      x86_64: "https://github.com/abood202/my-app-site/releases/download/v1.0.0/app-x86_64-release.apk",
    };

    const el = (id) => document.getElementById(id);

    function ua() { return navigator.userAgent || ""; }
    function uaLower(){ return ua().toLowerCase(); }

    function platformGuess(){
      if (navigator.userAgentData && navigator.userAgentData.platform) {
        return String(navigator.userAgentData.platform);
      }
      if (uaLower().includes("android")) return "Android";
      if (uaLower().includes("iphone") || uaLower().includes("ipad") || uaLower().includes("ios")) return "iOS";
      if (uaLower().includes("windows")) return "Windows";
      if (uaLower().includes("mac os")) return "macOS";
      if (uaLower().includes("linux")) return "Linux";
      return "Unknown";
    }

    function isAndroid(){
      const p = platformGuess().toLowerCase();
      return p.includes("android") || uaLower().includes("android");
    }

    // ⚠️ المتصفح لا يعطي ABI رسميًا 100%، هذا ترشيح بناءً على User-Agent
    function guessAbi(){
      const u = uaLower();

      if (u.includes("x86_64") || (u.includes("x86") && !u.includes("arm")) || u.includes("intel")) return "x86_64";
      if (u.includes("aarch64") || u.includes("armv8") || u.includes("arm64")) return "arm64";
      if (u.includes("armv7") || u.includes("armeabi-v7a") || u.includes("armeabi")) return "v7a";

      return "arm64";
    }

    function prettyAbi(abi){
      if (abi === "arm64") return "arm64-v8a";
      if (abi === "v7a") return "armeabi-v7a";
      if (abi === "x86_64") return "x86_64";
      return "غير معروف";
    }

    function setEnvPill(){
      const platform = platformGuess();
      const android = isAndroid();

      el("envDot").style.background = android ? "rgba(34,197,94,.95)" : "rgba(239,68,68,.95)";
      el("envDot").style.boxShadow = android ? "0 0 0 4px rgba(34,197,94,.18)" : "0 0 0 4px rgba(239,68,68,.16)";
      el("envText").textContent = android ? `Android — جاهز للتنزيل` : `${platform} — ملفات APK لأندرويد فقط`;
    }

    function fillDeviceInfo(){
      const platform = platformGuess();
      const android = isAndroid();
      const abi = guessAbi();

      el("deviceInfo").innerHTML =
        `<span class="kbd">Platform</span> ${platform}<br>` +
        `<span class="kbd">Android</span> ${android ? "Yes" : "No"}<br>` +
        `<span class="kbd">ABI guess</span> ${prettyAbi(abi)}<br>` +
        `<span class="kbd">UA</span> <span class="ua">${ua()}</span>`;
    }

    function smartDownload(e){
      e.preventDefault();

      const status = el("smartStatus");
      const android = isAndroid();
      const abi = guessAbi();

      if (!android){
        status.innerHTML = `<span class="muted">الحالة:</span> هذا الجهاز ليس Android. استخدم جهاز أندرويد للتثبيت.`;
        return;
      }

      const pick = APK[abi] ? abi : "arm64";
      status.innerHTML = `<span class="muted">الحالة:</span> تم ترشيح <b>${prettyAbi(pick)}</b> وسيبدأ التنزيل الآن…`;

      window.location.href = APK[pick];
    }

    // تفعيل
    setEnvPill();
    fillDeviceInfo();

    el("smartBtn").addEventListener("click", smartDownload);

    // ربط الروابط اليدوية من الثوابت
    el("btnArm64").href = APK.arm64;
    el("btnV7a").href   = APK.v7a;
    el("btnX86").href   = APK.x86_64;
  </script>
</body>
</html>
